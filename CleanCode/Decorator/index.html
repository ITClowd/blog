<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="tags: #cleancode/designpatterns
Decorator Intent Decorator is a structural design pattern that lets you attach new behaviors to objects by placing these objects inside special wrapper objects that contain the behaviors."><meta property="og:title" content="Decorator"><meta property="og:description" content="tags: #cleancode/designpatterns
Decorator Intent Decorator is a structural design pattern that lets you attach new behaviors to objects by placing these objects inside special wrapper objects that contain the behaviors."><meta property="og:type" content="website"><meta property="og:image" content="https://knowledge.vogel.businessicon.png"><meta property="og:url" content="https://knowledge.vogel.business/CleanCode/Decorator/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content="Decorator"><meta name=twitter:description content="tags: #cleancode/designpatterns
Decorator Intent Decorator is a structural design pattern that lets you attach new behaviors to objects by placing these objects inside special wrapper objects that contain the behaviors."><meta name=twitter:image content="https://knowledge.vogel.businessicon.png"><title>Decorator</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://knowledge.vogel.business/icon.png><link href=https://knowledge.vogel.business/styles.b369a84b3c6e6bfd686ad1f9da65641c.min.css rel=stylesheet><link href=https://knowledge.vogel.business/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://knowledge.vogel.business/js/darkmode.49e02f55b6384a9e088ce2395a1ab3fb.min.js></script>
<script src=https://knowledge.vogel.business/js/util.a0ccf91e1937fe761a74da4946452710.min.js></script>
<link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script async src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script async src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script async src=https://knowledge.vogel.business/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://knowledge.vogel.business/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://knowledge.vogel.business/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://knowledge.vogel.business/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://knowledge.vogel.business",fetchData=Promise.all([fetch("https://knowledge.vogel.business/indices/linkIndex.05877276bafea51c34835ef637a0896f.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://knowledge.vogel.business/indices/contentIndex.033a8de1cbae8bcc739bc6f4ccdb68d0.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://knowledge.vogel.business",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!0;drawGraph("https://knowledge.vogel.business",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/knowledge.vogel.business\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=knowledge.vogel.business src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://knowledge.vogel.business/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a class=root-title href=https://knowledge.vogel.business>Momolem's Digital Garden</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Decorator</h1><p class=meta>Last updated
Unknown</p><ul class=tags></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#intent>Intent</a></li><li><a href=#problem>Problem</a></li><li><a href=#solution> Solution</a></li><li><a href=#real-world-analogy> Real-World Analogy</a></li><li><a href=#structure>Structure</a></li><li><a href=#pseudocode> Pseudocode</a></li><li><a href=#applicability>Applicability</a></li><li><a href=#how-to-implement>How to Implement</a></li><li><a href=#pro-and--cons>Pro and Cons</a></li><li><a href=#relations-with-other-patterns>Relations with Other Patterns</a></li></ol></nav></details></aside><p>tags: #cleancode/designpatterns</p><a href=#decorator><h1 id=decorator><span class=hanchor arialabel=Anchor># </span>Decorator</h1></a><a href=#intent><h2 id=intent><span class=hanchor arialabel=Anchor># </span>Intent</h2></a><p><strong>Decorator</strong> is a structural design pattern that lets you attach new behaviors to objects by placing these objects inside special wrapper objects that contain the behaviors.</p><a href=#problem><h2 id=problem><span class=hanchor arialabel=Anchor># </span>Problem</h2></a><p>Imagine that you’re working on a notification library which lets other programs notify their users about important events.</p><p>The initial version of the library was based on the <code>Notifier</code> class that had only a few fields, a constructor and a single <code>send</code> method. The method could accept a message argument from a client and send the message to a list of emails that were passed to the notifier via its constructor. A third-party app which acted as a client was supposed to create and configure the notifier object once, and then use it each time something important happened.</p><p><img src=https://refactoring.guru/images/patterns/diagrams/decorator/problem1-en.png width=auto alt="Structure of the library before applying the Decorator pattern"></p><p>A program could use the notifier class to send notifications about important events to a predefined set of emails.</p><p>At some point, you realize that users of the library expect more than just email notifications. Many of them would like to receive an SMS about critical issues. Others would like to be notified on Facebook and, of course, the corporate users would love to get Slack notifications.</p><p><img src=https://refactoring.guru/images/patterns/diagrams/decorator/problem2.png width=auto alt="Structure of the library after implementing other notification types"></p><p>Each notification type is implemented as a notifier’s subclass.</p><p>How hard can that be? You extended the <code>Notifier</code> class and put the additional notification methods into new subclasses. Now the client was supposed to instantiate the desired notification class and use it for all further notifications.</p><p>But then someone reasonably asked you, “Why can’t you use several notification types at once? If your house is on fire, you’d probably want to be informed through every channel.”</p><p>You tried to address that problem by creating special subclasses which combined several notification methods within one class. However, it quickly became apparent that this approach would bloat the code immensely, not only the library code but the client code as well.</p><p><img src=https://refactoring.guru/images/patterns/diagrams/decorator/problem3.png width=auto alt="Structure of the library after creating class combinations"></p><p>Combinatorial explosion of subclasses.</p><p>You have to find some other way to structure notifications classes so that their number won’t accidentally break some Guinness record.</p><a href=#solution><h2 id=solution><span class=hanchor arialabel=Anchor># </span> Solution</h2></a><p>Extending a class is the first thing that comes to mind when you need to alter an object’s behavior. However, inheritance has several serious caveats that you need to be aware of.</p><ul><li>Inheritance is static. You can’t alter the behavior of an existing object at runtime. You can only replace the whole object with another one that’s created from a different subclass.</li><li>Subclasses can have just one parent class. In most languages, inheritance doesn’t let a class inherit behaviors of multiple classes at the same time.</li></ul><p>One of the ways to overcome these caveats is by using <em>Aggregation</em> or <em>Composition</em>  instead of <em>Inheritance</em>. Both of the alternatives work almost the same way: one object <em>has a</em> reference to another and delegates it some work, whereas with inheritance, the object itself <em>is</em> able to do that work, inheriting the behavior from its superclass.</p><p>With this new approach you can easily substitute the linked “helper” object with another, changing the behavior of the container at runtime. An object can use the behavior of various classes, having references to multiple objects and delegating them all kinds of work. Aggregation/composition is the key principle behind many design patterns, including Decorator. On that note, let’s return to the pattern discussion.</p><p><img src=https://refactoring.guru/images/patterns/diagrams/decorator/solution1-en.png width=auto alt="Inheritance vs. Aggregation"></p><p>Inheritance vs. Aggregation</p><p>“Wrapper” is the alternative nickname for the Decorator pattern that clearly expresses the main idea of the pattern. A <em>wrapper</em> is an object that can be linked with some <em>target</em> object. The wrapper contains the same set of methods as the target and delegates to it all requests it receives. However, the wrapper may alter the result by doing something either before or after it passes the request to the target.</p><p>When does a simple wrapper become the real decorator? As I mentioned, the wrapper implements the same interface as the wrapped object. That’s why from the client’s perspective these objects are identical. Make the wrapper’s reference field accept any object that follows that interface. This will let you cover an object in multiple wrappers, adding the combined behavior of all the wrappers to it.</p><p>In our notifications example, let’s leave the simple email notification behavior inside the base <code>Notifier</code> class, but turn all other notification methods into decorators.</p><p><img src=https://refactoring.guru/images/patterns/diagrams/decorator/solution2.png width=auto alt="The solution with the Decorator pattern"></p><p>Various notification methods become decorators.</p><p>The client code would need to wrap a basic notifier object into a set of decorators that match the client’s preferences. The resulting objects will be structured as a stack.</p><p><img src=https://refactoring.guru/images/patterns/diagrams/decorator/solution3-en.png width=auto alt="Apps might configure complex stacks of notification decorators"></p><p>Apps might configure complex stacks of notification decorators.</p><p>The last decorator in the stack would be the object that the client actually works with. Since all decorators implement the same interface as the base notifier, the rest of the client code won’t care whether it works with the “pure” notifier object or the decorated one.</p><p>We could apply the same approach to other behaviors such as formatting messages or composing the recipient list. The client can decorate the object with any custom decorators, as long as they follow the same interface as the others.</p><a href=#real-world-analogy><h2 id=real-world-analogy><span class=hanchor arialabel=Anchor># </span> Real-World Analogy</h2></a><p><img src=https://refactoring.guru/images/patterns/content/decorator/decorator-comic-1.png width=auto alt="Example of the Decorator pattern"></p><p>You get a combined effect from wearing multiple pieces of clothing.</p><p>Wearing clothes is an example of using decorators. When you’re cold, you wrap yourself in a sweater. If you’re still cold with a sweater, you can wear a jacket on top. If it’s raining, you can put on a raincoat. All of these garments “extend” your basic behavior but aren’t part of you, and you can easily take off any piece of clothing whenever you don’t need it.</p><a href=#structure><h2 id=structure><span class=hanchor arialabel=Anchor># </span>Structure</h2></a><p><img src=https://refactoring.guru/images/patterns/diagrams/decorator/structure.png width=auto alt="Structure of the Decorator design pattern"></p><ol><li><p>The <strong>Component</strong> declares the common interface for both wrappers and wrapped objects.</p></li><li><p><strong>Concrete Component</strong> is a class of objects being wrapped. It defines the basic behavior, which can be altered by decorators.</p></li><li><p>The <strong>Base Decorator</strong> class has a field for referencing a wrapped object. The field’s type should be declared as the component interface so it can contain both concrete components and decorators. The base decorator delegates all operations to the wrapped object.</p></li><li><p><strong>Concrete Decorators</strong> define extra behaviors that can be added to components dynamically. Concrete decorators override methods of the base decorator and execute their behavior either before or after calling the parent method.</p></li><li><p>The <strong>Client</strong> can wrap components in multiple layers of decorators, as long as it works with all objects via the component interface.</p></li></ol><a href=#pseudocode><h2 id=pseudocode><span class=hanchor arialabel=Anchor># </span> Pseudocode</h2></a><p>In this example, the <strong>Decorator</strong> pattern lets you compress and encrypt sensitive data independently from the code that actually uses this data.</p><p><img src=https://refactoring.guru/images/patterns/diagrams/decorator/example.png width=auto alt="Structure of the Decorator pattern example"></p><p>The encryption and compression decorators example.</p><p>The application wraps the data source object with a pair of decorators. Both wrappers change the way the data is written to and read from the disk:</p><ul><li><p>Just before the data is <strong>written to disk</strong>, the decorators encrypt and compress it. The original class writes the encrypted and protected data to the file without knowing about the change.</p></li><li><p>Right after the data is <strong>read from disk</strong>, it goes through the same decorators, which decompress and decode it.</p></li></ul><p>The decorators and the data source class implement the same interface, which makes them all interchangeable in the client code.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=c1>// The component interface defines operations that can be
</span></span></span><span class=line><span class=cl><span class=c1>// altered by decorators.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>interface</span> <span class=nc>DataSource</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=n>writeData</span><span class=p>(</span><span class=k>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=n>readData</span><span class=p>():</span><span class=k>data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Concrete components provide default implementations for the
</span></span></span><span class=line><span class=cl><span class=c1>// operations. There might be several variations of these
</span></span></span><span class=line><span class=cl><span class=c1>// classes in a program.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>FileDataSource</span> <span class=n>implements</span> <span class=n>DataSource</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>    <span class=k>constructor</span> <span class=n>FileDataSource</span><span class=p>(</span><span class=n>filename</span><span class=p>)</span> <span class=p>{</span> <span class=o>..</span><span class=p>.</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=n>writeData</span><span class=p>(</span><span class=k>data</span><span class=p>)</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Write data to file.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=n>readData</span><span class=p>():</span><span class=k>data</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Read data from file.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// The base decorator class follows the same interface as the
</span></span></span><span class=line><span class=cl><span class=c1>// other components. The primary purpose of this class is to
</span></span></span><span class=line><span class=cl><span class=c1>// define the wrapping interface for all concrete decorators.
</span></span></span><span class=line><span class=cl><span class=c1>// The default implementation of the wrapping code might include
</span></span></span><span class=line><span class=cl><span class=c1>// a field for storing a wrapped component and the means to
</span></span></span><span class=line><span class=cl><span class=c1>// initialize it.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>DataSourceDecorator</span> <span class=n>implements</span> <span class=n>DataSource</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>    <span class=k>protected</span> <span class=k>field</span> <span class=n>wrappee</span><span class=p>:</span> <span class=n>DataSource</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>constructor</span> <span class=n>DataSourceDecorator</span><span class=p>(</span><span class=n>source</span><span class=p>:</span> <span class=n>DataSource</span><span class=p>)</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>        <span class=n>wrappee</span> <span class=p>=</span> <span class=n>source</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// The base decorator simply delegates all work to the
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// wrapped component. Extra behaviors can be added in
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// concrete decorators.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>method</span> <span class=n>writeData</span><span class=p>(</span><span class=k>data</span><span class=p>)</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>        <span class=n>wrappee</span><span class=p>.</span><span class=n>writeData</span><span class=p>(</span><span class=k>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Concrete decorators may call the parent implementation of
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// the operation instead of calling the wrapped object
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// directly. This approach simplifies extension of decorator
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// classes.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>method</span> <span class=n>readData</span><span class=p>():</span><span class=k>data</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>wrappee</span><span class=p>.</span><span class=n>readData</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Concrete decorators must call methods on the wrapped object,
</span></span></span><span class=line><span class=cl><span class=c1>// but may add something of their own to the result. Decorators
</span></span></span><span class=line><span class=cl><span class=c1>// can execute the added behavior either before or after the
</span></span></span><span class=line><span class=cl><span class=c1>// call to a wrapped object.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>EncryptionDecorator</span> <span class=n>extends</span> <span class=n>DataSourceDecorator</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=n>writeData</span><span class=p>(</span><span class=k>data</span><span class=p>)</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 1. Encrypt passed data.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// 2. Pass encrypted data to the wrappee&#39;s writeData
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// method.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=n>readData</span><span class=p>():</span><span class=k>data</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 1. Get data from the wrappee&#39;s readData method.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// 2. Try to decrypt it if it&#39;s encrypted.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// 3. Return the result.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// You can wrap objects in several layers of decorators.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>CompressionDecorator</span> <span class=n>extends</span> <span class=n>DataSourceDecorator</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=n>writeData</span><span class=p>(</span><span class=k>data</span><span class=p>)</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 1. Compress passed data.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// 2. Pass compressed data to the wrappee&#39;s writeData
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// method.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=n>readData</span><span class=p>():</span><span class=k>data</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 1. Get data from the wrappee&#39;s readData method.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// 2. Try to decompress it if it&#39;s compressed.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// 3. Return the result.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// Option 1. A simple example of a decorator assembly.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>Application</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=n>dumbUsageExample</span><span class=p>()</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>        <span class=n>source</span> <span class=p>=</span> <span class=n>new</span> <span class=n>FileDataSource</span><span class=p>(</span><span class=s2>&#34;somefile.dat&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>source</span><span class=p>.</span><span class=n>writeData</span><span class=p>(</span><span class=n>salaryRecords</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>// The target file has been written with plain data.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>source</span> <span class=p>=</span> <span class=n>new</span> <span class=n>CompressionDecorator</span><span class=p>(</span><span class=n>source</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>source</span><span class=p>.</span><span class=n>writeData</span><span class=p>(</span><span class=n>salaryRecords</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>// The target file has been written with compressed
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// data.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>source</span> <span class=p>=</span> <span class=n>new</span> <span class=n>EncryptionDecorator</span><span class=p>(</span><span class=n>source</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>// The source variable now contains this:
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// Encryption &gt; Compression &gt; FileDataSource
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>source</span><span class=p>.</span><span class=n>writeData</span><span class=p>(</span><span class=n>salaryRecords</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>// The file has been written with compressed and
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// encrypted data.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// Option 2. Client code that uses an external data source.
</span></span></span><span class=line><span class=cl><span class=c1>// SalaryManager objects neither know nor care about data
</span></span></span><span class=line><span class=cl><span class=c1>// storage specifics. They work with a pre-configured data
</span></span></span><span class=line><span class=cl><span class=c1>// source received from the app configurator.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>SalaryManager</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>    <span class=k>field</span> <span class=n>source</span><span class=p>:</span> <span class=n>DataSource</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>constructor</span> <span class=n>SalaryManager</span><span class=p>(</span><span class=n>source</span><span class=p>:</span> <span class=n>DataSource</span><span class=p>)</span> <span class=p>{</span> <span class=o>..</span><span class=p>.</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=n>load</span><span class=p>()</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>source</span><span class=p>.</span><span class=n>readData</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=n>save</span><span class=p>()</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>        <span class=n>source</span><span class=p>.</span><span class=n>writeData</span><span class=p>(</span><span class=n>salaryRecords</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...Other useful methods...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// The app can assemble different stacks of decorators at
</span></span></span><span class=line><span class=cl><span class=c1>// runtime, depending on the configuration or environment.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>class</span> <span class=nc>ApplicationConfigurator</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=n>configurationExample</span><span class=p>()</span> <span class=k>is</span>
</span></span><span class=line><span class=cl>        <span class=n>source</span> <span class=p>=</span> <span class=n>new</span> <span class=n>FileDataSource</span><span class=p>(</span><span class=s2>&#34;salary.dat&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>enabledEncryption</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>source</span> <span class=p>=</span> <span class=n>new</span> <span class=n>EncryptionDecorator</span><span class=p>(</span><span class=n>source</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>enabledCompression</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>source</span> <span class=p>=</span> <span class=n>new</span> <span class=n>CompressionDecorator</span><span class=p>(</span><span class=n>source</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>logger</span> <span class=p>=</span> <span class=n>new</span> <span class=n>SalaryManager</span><span class=p>(</span><span class=n>source</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>salary</span> <span class=p>=</span> <span class=n>logger</span><span class=p>.</span><span class=n>load</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span></code></pre></td></tr></table></div></div><a href=#applicability><h2 id=applicability><span class=hanchor arialabel=Anchor># </span>Applicability</h2></a><ul><li><p>Use the Decorator pattern when you need to be able to assign extra behaviors to objects at runtime without breaking the code that uses these objects.
 The Decorator lets you structure your business logic into layers, create a decorator for each layer and compose objects with various combinations of this logic at runtime. The client code can treat all these objects in the same way, since they all follow a common interface.</p></li><li><p>Use the pattern when it’s awkward or not possible to extend an object’s behavior using inheritance.
Many programming languages have the <code>final</code> keyword that can be used to prevent further extension of a class. For a final class, the only way to reuse the existing behavior would be to wrap the class with your own wrapper, using the Decorator pattern.</p></li></ul><a href=#how-to-implement><h2 id=how-to-implement><span class=hanchor arialabel=Anchor># </span>How to Implement</h2></a><ol><li>Make sure your business domain can be represented as a primary component with multiple optional layers over it.</li><li>Figure out what methods are common to both the primary component and the optional layers. Create a component interface and declare those methods there.</li><li>Create a concrete component class and define the base behavior in it.</li><li>Create a base decorator class. It should have a field for storing a reference to a wrapped object. The field should be declared with the component interface type to allow linking to concrete components as well as decorators. The base decorator must delegate all work to the wrapped object.</li><li>Make sure all classes implement the component interface.</li><li>Create concrete decorators by extending them from the base decorator. A concrete decorator must execute its behavior before or after the call to the parent method (which always delegates to the wrapped object).</li><li>The client code must be responsible for creating decorators and composing them in the way the client needs.</li></ol><a href=#pro-and--cons><h2 id=pro-and--cons><span class=hanchor arialabel=Anchor># </span>Pro and Cons</h2></a><table><thead><tr><th>Pros</th><th>Cons</th></tr></thead><tbody><tr><td>You can extend an object’s behavior without making a new subclass.</td><td>It’s hard to remove a specific wrapper from the wrappers stack.</td></tr><tr><td>You can add or remove responsibilities from an object at runtime.</td><td>It’s hard to implement a decorator in such a way that its behavior doesn’t depend on the order in the decorators stack.</td></tr><tr><td>You can combine several behaviors by wrapping an object into multiple decorators.</td><td>The initial configuration code of layers might look pretty ugly.</td></tr><tr><td><a href=/CleanCode/Single-Responsibility-Principle rel=noopener class=internal-link data-src=/CleanCode/Single-Responsibility-Principle>Single Responsibility Principle</a>. You can divide a monolithic class that implements many possible variants of behavior into several smaller classes.</td><td></td></tr></tbody></table><a href=#relations-with-other-patterns><h2 id=relations-with-other-patterns><span class=hanchor arialabel=Anchor># </span>Relations with Other Patterns</h2></a><p><a href=/CleanCode/Adapter rel=noopener class=internal-link data-src=/CleanCode/Adapter>Adapter</a> changes the interface of an existing object, while Decorator enhances an object without changing its interface. In addition, Decorator supports recursive composition, which isn’t possible when you use <a href=/CleanCode/Adapter rel=noopener class=internal-link data-src=/CleanCode/Adapter>Adapter</a>.</p><p><a href=/CleanCode/Adapter rel=noopener class=internal-link data-src=/CleanCode/Adapter>Adapter</a> provides a different interface to the wrapped object, <a href=/CleanCode/Proxy rel=noopener class=internal-link data-src=/CleanCode/Proxy>Proxy</a> provides it with the same interface, and Decorator provides it with an enhanced interface.</p><p><a href=/CleanCode/Chain-of-Responsibility rel=noopener class=internal-link data-src=/CleanCode/Chain-of-Responsibility>Chain of Responsibility</a> and Decorator have very similar class structures. Both patterns rely on recursive composition to pass the execution through a series of objects. However, there are several crucial differences.</p><p>The <a href=/CleanCode/Chain-of-Responsibility rel=noopener class=internal-link data-src=/CleanCode/Chain-of-Responsibility>CoR</a> handlers can execute arbitrary operations independently of each other. They can also stop passing the request further at any point. On the other hand, various Decorators can extend the object’s behavior while keeping it consistent with the base interface. In addition, decorators aren’t allowed to break the flow of the request.</p><p><a href=/CleanCode/Composite rel=noopener class=internal-link data-src=/CleanCode/Composite>Composite</a> and Decorator have similar structure diagrams since both rely on recursive composition to organize an open-ended number of objects.</p><p>A Decorator is like a <a href=/CleanCode/Composite rel=noopener class=internal-link data-src=/CleanCode/Composite>Composite</a> but only has one child component. There’s another significant difference: Decorator adds additional responsibilities to the wrapped object, while <a href=/CleanCode/Composite rel=noopener class=internal-link data-src=/CleanCode/Composite>Composite</a> just “sums up” its children’s results.</p><p>However, the patterns can also cooperate: you can use Decorator to extend the behavior of a specific object in the <a href=/CleanCode/Composite rel=noopener class=internal-link data-src=/CleanCode/Composite>Composite</a> tree.</p><p>Designs that make heavy use of <a href=/CleanCode/Composite rel=noopener class=internal-link data-src=/CleanCode/Composite>Composite</a> and Decorator can often benefit from using <a href=/CleanCode/Prototype rel=noopener class=internal-link data-src=/CleanCode/Prototype>Prototype</a>. Applying the pattern lets you clone complex structures instead of re-constructing them from scratch.</p><p>Decorator lets you change the skin of an object, while <a href=/CleanCode/Strategy rel=noopener class=internal-link data-src=/CleanCode/Strategy>Strategy</a> lets you change the guts.</p><p>Decorator and <a href=/CleanCode/Proxy rel=noopener class=internal-link data-src=/CleanCode/Proxy>Proxy</a> have similar structures, but very different intents. Both patterns are built on the composition principle, where one object is supposed to delegate some of the work to another. The difference is that a <a href=/CleanCode/Proxy rel=noopener class=internal-link data-src=/CleanCode/Proxy>Proxy</a> usually manages the life cycle of its service object on its own, whereas the composition of Decorators is always controlled by the client.</p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/CleanCode/Adapter/ data-ctx=CleanCode/Decorator data-src=/CleanCode/Adapter class=internal-link>Adapter</a></li><li><a href=/CleanCode/Chain-of-Responsibility/ data-ctx=CleanCode/Decorator data-src=/CleanCode/Chain-of-Responsibility class=internal-link>Chain of Responsibility</a></li><li><a href=/CleanCode/Composite/ data-ctx=CleanCode/Decorator data-src=/CleanCode/Composite class=internal-link>Composite</a></li><li><a href=/CleanCode/Design-Patterns/ data-ctx=CleanCode/Decorator data-src=/CleanCode/Design-Patterns class=internal-link>Design Patterns</a></li><li><a href=/CleanCode/Proxy/ data-ctx=CleanCode/Decorator data-src=/CleanCode/Proxy class=internal-link>Proxy</a></li><li><a href=/CleanCode/Strategy/ data-ctx=CleanCode/Decorator data-src=/CleanCode/Strategy class=internal-link>Strategy</a></li></ul></div><div><script async src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://knowledge.vogel.business/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Moritz Vogel using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2023</p><ul><li><a href=https://knowledge.vogel.business>Home</a></li><li><a href=https://github.com/Momolem>GitHub</a></li><li><a href=https://gitlab.com/Momolem>Gitlab</a></li></ul></footer></div></div></body></html>